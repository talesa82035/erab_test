;****************************************
;縁結び系の処理に使う特殊関数
;****************************************
;・使い方
;「2328」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;「<スタイル名>」を任意のスタイル名に変更する
;****************************************

;--------------------------------------------------
;スタイル変更基礎関数
;--------------------------------------------------
@スタイル変更_2328(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
;この関数はいくつ別スタイル作ってもキャラ毎に一個
;必須関数、スタイル変更を追加する場合、必ず作成すること

SELECTCASE 動作モード
	CASE "スタイル名取得"
        ;ここは触らない
		VARSET RESULTS
		RESULTS:0 = %NAME:対象キャラ%
		RESULTS:10 = ノーマル

		;RESULTS:Xに名前全体を、RESULTS:X+10にリミテッドや水着など通称(？)を入れる
        ;例：
		; RESULTS:1 = [強化状態二つ名]テスト太郎
		; RESULTS:11 = 強化スタイル
		IF 陥落チェック(対象キャラ)
			RESULTS:1 = [超熱血高校生]バーニングバツ
			RESULTS:11 = バランス強化
		ENDIF
        
		; 複数スタイルを作りたい場合はRESULTS:2、RESULTS:12のように数字をふやしていく
        
	CASE @"スタイル解説_%NAME:対象キャラ%"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += @"■%NAME:対象キャラ%<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "通常時。ステータス・属性変動なし。<br>"
		TSTR:スタイル解説 += "<br>"
        ;このCALLはそのままで良い
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, NAME:対象キャラ)
	CASE "スタイル解説_<スタイル名>"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += "■[超熱血高校生]バーニングバツ<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "忌野雷蔵による厳しい修行の末、潜在能力を限界まで引き出した姿。<br>"
		TSTR:スタイル解説 += "バツの上半身は鎖帷子一枚にはだけている。<br>"
		TSTR:スタイル解説 += "攻撃・防御・行動速度が上昇。<br>"
		TSTR:スタイル解説 += "<br>"
        ;このCALLはそのままで良い、戦闘アビが変動しない場合は消しても良い
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, "[超熱血高校生]バーニングバツ")
	CASE "変更後処理"
		;CSTR:対象キャラ:スタイル管理文字列をキーにして処理を実行
		;一人称や二人称、素質の変化などの調教側ステータスの変更を想定
        ;戦闘ステータスは別の関数
		SELECTCASE CSTR:対象キャラ:スタイル管理文字列
			CASE "[熱血高校生]一文字伐"
                ;通常時に戻す処理
			CASE "[超熱血高校生]バーニングバツ"
                ;スタイル変更時の処理
		ENDSELECT
ENDSELECT


;--------------------------------------------------
;スタイル変更時、戦闘ステータス変動
;--------------------------------------------------
@スタイルステータス補正_超熱血高校生_バーニングバツ(対象キャラ)
#DIM 対象キャラ
;関数名に[]が使えないため、しょうがなく[]排除時の文字列をキーに
;例えば[強化状態二つ名]テスト太郎というスタイルなら、
;@スタイルステータス補正_強化状態二つ名_テスト太郎　という関数名にすること

;属性の変更、火とか水とか文字を変えるだけでOK
装備ステータス補正保存:対象キャラ:基礎属性変更 = 属性文字列数値変換("火") + 10
;ステータスの変更
装備ステータス補正保存:対象キャラ:攻撃力 += 100
装備ステータス補正保存:対象キャラ:防御力 += 100
装備ステータス補正保存:対象キャラ:行動速度 += 100

;装備再計算時にこの関数は呼ばれる
;補正の順番は「スタイル＞指輪＞耳飾り＞料理など＞パーティキャラ補正」
;補正可能なステータスは「装備ステータス補正保存.ERD」を参照のこと


;--------------------------------------------------
;スタイル変更時、使用可能アビリティの変動
;--------------------------------------------------
;テンプレート「固有アビリティ_キャラ名.ERB」に記述する
;「@固有アビ_2328_任意の文字列(ARGS, キャラ番号)」の上部にある分岐を修正する

; IF スタイル判定関数(キャラ番号, "デフォルト") == 0
; を以下のように修正
; IF スタイル判定関数(キャラ番号, "<スタイル名>") == 0

;こうすることで、そのアビは<スタイル名>になっている時のみ使用可能という意味になる


;--------------------------------------------------
;スタイル変更時、使用可能奥義の変動
;--------------------------------------------------
;奥義はアビのように複数種類を使うことを想定していないため、別関数を呼ぶことを推奨。
;奥義テンプレにある以下の分岐のうち、任意のスタイル名の部分を編集した上で
;奥義テンプレをコピーして作成した関数に貼り付け、中身を記述する。

@固有奥義_2328(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名

;スタイルによる奥義の変更部分、スタイル変化_キャラ名.ERBを参照
IF CSTR:キャラ番号:スタイル管理文字列 == "[超熱血高校生]バーニングバツ"
	CALL 固有奥義_2328_バーニングバツ専用奥義(ARGS, キャラ番号)
	RETURN RESULT
ENDIF

奥義名 = 全開気合弾
奥義威力 = 300

;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと


;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰を攻撃しますか？」と表示される。
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、奥義使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の奥義：（奥義名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>より強力な気合弾を放つ。敵単体に火属性大ダメージ。
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる

		;処理の都合上、ここから奥義ダメージまでにリセットを噛ませてないため
		;必要な場合を除きここでリセット
		CALL アビ汎用変数文字列リセット
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		IF 奥義名 == "全開気合弾"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 300
			CALL アビテンプレート_ダメージ処理_火属性
		ENDIF
ENDSELECT

@固有奥義_2328_バーニングバツ専用奥義(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名

;忌野流モズ落としにすると『そもそも超大型敵相手に投げ技掛けれるんか？』と悩んだ末にこれ
IF TALENT:恋慕 || TALENT:セフレ || TALENT:非エロ陥落
	奥義名 = 熱血全開気合弾
	奥義威力 = 0
ENDIF
;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと


;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰を攻撃しますか？」と表示される。
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、奥義使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の奥義：（奥義名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 奥義名 == "熱血全開気合弾"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>強化された全開気合弾。敵単体に火属性大ダメージ。
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる

		;処理の都合上、ここから奥義ダメージまでにリセットを噛ませてないため
		;必要な場合を除きここでリセット
		CALL アビ汎用変数文字列リセット
	CASE "奥義追加効果"
		IF 奥義名 == "熱血全開気合弾"
			CALL アビ対象選択テンプレート_敵全体_生者のみ
			アビ汎用変数:効果割合 = 420
			CALL アビテンプレート_ダメージ処理_火属性
		ENDIF
ENDSELECT
;--------------------------------------------------
;キャラについての解説
;--------------------------------------------------
@口上_ステータス画面_キャラ解説_2328(対象キャラ)
#DIM 対象キャラ
;EXキャラの出典を解説したり、キャラの設定・背景を解説するもの

KSTR:(K++) = 　太陽学園高等部の生徒。喧嘩っ早く、曲がったことが大嫌いな熱血男子高生。
KSTR:(K++) = 　正義感と母親譲りの優しさを併せ持っている。
KSTR:(K++) = 　二度にわたる学園の危機をひなた・恭介と共に切り抜けてきた。
KSTR:(K++) = 　
KSTR:(K++) = 　誕生日：1月1日
KSTR:(K++) = 　血液型：O型
KSTR:(K++) = 　好きな物：真っ直ぐな物・忍者・雫（母親）
KSTR:(K++) = 　嫌いな物：犬・曲がったこと・理不尽なこと
KSTR:(K++) = 　特技：早食い
