
@ダンジョン初期処理_境界への導き
;ダンジョン構造の読み込み
;0でない時、そのマスは存在する
#DIM 深度
#DIM 分岐

ダンジョンサブタイトル = GUIDE TO THE BOUNDARY
ダンジョンマス画像URL_伏せ状態 = 壁_暗雲
ダンジョン現在位置:0 = 0
ダンジョン現在位置:1 = 4
ダンジョン背景画像 = 背景_暗雲

;スタート地点は必ず存在
;初期からオープン済みなので3を入れる
;ビット0：存在するか　ビット1：移動できるか　ビット2：マスをオープンするか（ビット１をONにしないと無意味）　ビット3：入れないがオープンする場合に使用
;ビット4以降：自由枠。主に宝箱の開閉やイベント達成フラグなどに使用
IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}") == 0
	SETVAR @"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}", 3
ENDIF

FOR 深度, 1, 100
	LOCAL = 0
	FOR 分岐, 0, 9
		IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{深度}:{分岐}")
			;既にマス情報が入ってるなら飛ばす
			LOCAL = 1
			CONTINUE
		ELSEIF ENUMFUNCBEGINSWITH(@"ダンジョンマス情報_%ダンジョン名%_{深度}_{分岐}")
			LOCAL = 1
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:深度:分岐", 1
		ENDIF
	NEXT
	IF LOCAL
		ダンジョン最大深度 = 深度
	ENDIF
NEXT

@ダンジョン解説文_境界への導き

詳細文文字列受け渡し変数 = 
詳細文文字列受け渡し変数 += "星の民タピィラに授けられたクリスタルに導かれ、訪れた異様な空間。<br>"
詳細文文字列受け渡し変数 += "強力な魔物が生息しているが、クリスタルの指示通りに進めば戦闘せずに抜けることが出来るだろう。<br>"
詳細文文字列受け渡し変数 += "あるいは、あえて道を外れると貴重なアイテムを手に入れることが出来るかもしれない。<br>"

;推奨レベルを返す
RETURN 35



@敵討伐後処理_ダンジョン固有_境界への導き(討伐エネミー数)
;ダンジョン内で戦闘した後に呼ばれる関数、主にダンジョンごとのドロップアイテム取得に使用
;まだ敵データはリセットしていないので敵BATTLE_STATEで色々情報は取得可能
#DIM 討伐エネミー数
#DIM ドロップ確率
#DIMS ドロップアイテム

ドロップ確率 = 3 * 討伐エネミー数
ドロップアイテム = 星晶の欠片
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 3
ドロップアイテム = 星晶塊
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 5 * 討伐エネミー数
ドロップアイテム = 星晶の欠片
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 1 * 討伐エネミー数
ドロップアイテム = 白銀の古紋
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

;---------------------------------------------------------------------
;マップ構造
;---------------------------------------------------------------------
;上と下に分かれているマップ
;ただ下はほぼ行き止まりなので実質一本道
;---------------------------------------------------------------------

@ダンジョンマス情報_境界への導き_0_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 0
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "4_4")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きに従って騎空艇を飛ばし、特定の座標で高度をギリギリまで下げる。
			WSTR:(K++) = すると、周囲の景色が不思議に滲み──気付いた時には奇妙な空間に出ていた。
			KSTR:(K++) = 上下左右が雲に覆われている。空の世界でも%HTML_用語解説("赤き地平")%でもない……謎の空間だ。_PAGE
			WSTR:(K++) = ……周囲を見ると、後方に空間の歪みのようなものが見える。
			WSTR:(K++) = どうやら元の場所に戻ることは可能であるらしい。
			WSTR:(K++) = クリスタルは空間の奥を指し示している。先に進んでみよう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = ここは空の世界でも%HTML_用語解説("赤き地平")%でもない、妙な空間のようだ。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT





@ダンジョンマス情報_境界への導き_4_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 4
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		IF 初来訪マス判定用フラグ
			;移動直後はマスイベント発動しないので、移動先のルート開放をここで行う
			CALL 接続ルート全開放処理(12, 4)
		ENDIF
		ダンジョン現在位置:0 = 12
		ダンジョン現在位置:1 = 4
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 空間を騎空艇で進む。
			WSTR:(K++) = 周囲の風景にまるで変化がなく、じっと見つめていると上下左右の感覚すらなくなってしまいそうだ。
			WSTR:(K++) = クリスタルは<font color='#%カラーパレット_HTML("黄")%'>↑↑←↓</font>と方角を指し示している。
			WSTR:(K++) = この導きに従えば無事に進むことが出来るだろう。反面、別の道に進めば迷って元の場所に戻ってしまうかもしれない。
			WSTR:(K++) = 気を付けて進もう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
ENDSELECT







@ダンジョンマス情報_境界への導き_10_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 10
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "12_4")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		IF 無限ループ踏破フラグ == 2
			;正解ルート
			ダンジョン現在位置:0 = 14
			ダンジョン現在位置:1 = 4
			無限ループ踏破フラグ ++
		ELSEIF 無限ループ踏破フラグ >= 4
			;踏破済み
			ダンジョン現在位置:0 = 4
			ダンジョン現在位置:1 = 4
		ELSE
			;不正解ルート
			ダンジョン現在位置:0 = 4
			ダンジョン現在位置:1 = 4
			無限ループ踏破フラグ = 0
			WSTR:(K++) = 元の場所に戻ってしまった……道を間違えたようだ。もう一度進んでみよう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_境界への導き_12_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 12
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		IF 無限ループ踏破フラグ < 2
			;正解ルート
			ダンジョン現在位置:0 = 12
			ダンジョン現在位置:1 = 7
			無限ループ踏破フラグ ++
		ELSEIF 無限ループ踏破フラグ < 4
			;不正解ルート
			ダンジョン現在位置:0 = 4
			ダンジョン現在位置:1 = 4
			無限ループ踏破フラグ = 0
			WSTR:(K++) = 元の場所に戻ってしまった……道を間違えたようだ。もう一度進んでみよう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ELSE
			;踏破済み
			ダンジョン現在位置:0 = 16
			ダンジョン現在位置:1 = 1
		ENDIF
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_12_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 12
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_4")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "12_1")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "12_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "14_4")
	CASE "マスイベント"
		IF 無限ループ踏破フラグ < 4
			;条件未達
			SELECTCASE 無限ループ踏破フラグ
				CASE 0
					LOCALS = <font color='#%カラーパレット_HTML("真っ赤")%'>↑</font>↑←↓
				CASE 1
					LOCALS = ↑<font color='#%カラーパレット_HTML("真っ赤")%'>↑</font>←↓
				CASE 2
					LOCALS = ↑↑<font color='#%カラーパレット_HTML("真っ赤")%'>←</font>↓
				CASE 3
					LOCALS = ↑↑←<font color='#%カラーパレット_HTML("真っ赤")%'>↓</font>
			ENDSELECT
			KSTR:(K++) = クリスタルは%LOCALS%と指し示している。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 既にここの空域は突破済みだ。左に行けば元の場所に、それ以外を進めば先に進める。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_12_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 12
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること

		IF 無限ループ踏破フラグ == 3
			;正解ルート
			ダンジョン現在位置:0 = 16
			ダンジョン現在位置:1 = 1
			CALL 接続ルート全開放処理(16, 1)
			CALL 踏破マス開放処理
			CALL 画面再描画
			無限ループ踏破フラグ ++
			WSTR:(K++) = 周囲の雰囲気が変わった。どうやら先に進むことができたようだ。
			WSTR:(K++) = 気流を読むと、進めそうな道は幾つかあるが……クリスタルが指し示す道以外からは、妙な雰囲気を感じる。
			KSTR:(K++) = 道を外れると<font color='#%カラーパレット_HTML("黄")%'>強い敵が襲いかかって</font>きそうな雰囲気だ。_PAGE
			WSTR:(K++) = 反面、強い魔力も感じる。運が良ければ<font color='#%カラーパレット_HTML("黄")%'>良いアイテムを取得</font>出来るかもしれない。
			WSTR:(K++) = クリスタルに従って安全に進むか、危険を承知で道を外れるか……よく考えて進もう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化

		ELSEIF 無限ループ踏破フラグ >= 4
			;踏破済み
			ダンジョン現在位置:0 = 16
			ダンジョン現在位置:1 = 1
		ELSE
			;不正解ルート
			ダンジョン現在位置:0 = 4
			ダンジョン現在位置:1 = 4
			無限ループ踏破フラグ = 0
			WSTR:(K++) = 元の場所に戻ってしまった……道を間違えたようだ。もう一度進んでみよう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_境界への導き_14_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 14
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		IF 無限ループ踏破フラグ >= 4
			;踏破済み
			ダンジョン現在位置:0 = 16
			ダンジョン現在位置:1 = 1
		ELSE
			;不正解ルート
			ダンジョン現在位置:0 = 4
			ダンジョン現在位置:1 = 4
			無限ループ踏破フラグ = 0
			WSTR:(K++) = 元の場所に戻ってしまった……道を間違えたようだ。もう一度進んでみよう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_境界への導き_16_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 16
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "17_1")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 14
		ダンジョン現在位置:1 = 4
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_17_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 17
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_0")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_1")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_2")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「↑」を指し示している。
			WSTR:(K++) = 風の流れを読む限り、３つのルートに進むことが出来そうだが……。
			WSTR:(K++) = ともかく、先に進んでみよう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「↑」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_18_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 18
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きに逆らって周囲の探索を始める。
			WSTR:(K++) = 一見ただの雲と嵐の世界のように見えるが、たまに何らかの残骸が浮いていることがある。
			KSTR:(K++) = 偶発的にこの世界に落ちてきてしまった物品の成れの果てだろうか。_PAGE
			WSTR:(K++) = 残骸の中から、比較的形を保っているものを幾つか拾い上げてみる。
			WSTR:(K++) = やはり、ほとんどは劣化して崩れてしまったものばかりだが……一つだけまともな物が残っていた。
			WSTR:(K++) = どうやらジョブ証のようだ。多少古いがまだ問題なく使えそうである。
			KSTR:(K++) = いつのどこから零れ落ちた物かもわからない。拾ってしまっても構わないだろう。_PAGE
			WSTR:(K++) = %CALLNAME:MASTER%たちは「ダンサーの証」を手に入れた！
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL 汎用証取得処理("ダンサーの証")	
		ELSE
			KSTR:(K++) = もうめぼしいものは何も無い。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_18_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 18
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "21_6")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "21_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "21_8")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「→」を指し示している。
			WSTR:(K++) = 少し遠くの景色が歪んで見える。出口は先のようだが、近辺のエリアはそろそろ抜けられそうだ。
			WSTR:(K++) = このままクリスタルに従って進んでいこう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「→」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_19_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_4")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きに従い、奇妙な空間を進む。
			WSTR:(K++) = 周囲からは敵対的な雰囲気を感じるが、魔物の姿は見えない。
			WSTR:(K++) = クリスタルはうまく生息域を避けるルートを取っているようだ。
			WSTR:(K++) = このままの調子で進んでいこう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 周囲からは敵対的な雰囲気を感じる。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_19_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@エネミーランダム登録_境界への導き()
SELECTCASE RAND:8
	CASE 0
		敵BATTLE_STATE_STR:0:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアα
	CASE 1
		敵BATTLE_STATE_STR:0:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:4:エネミー名 = Lv35_エンプティ・コアα
	CASE 2
		敵BATTLE_STATE_STR:0:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:1:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:4:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:5:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:6:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:7:エネミー名 = Lv35_エンプティ・コアβ
	CASE 3
		敵BATTLE_STATE_STR:1:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:4:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:5:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:6:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:7:エネミー名 = Lv35_エンプティ・コアβ
	CASE 4
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアγ
	CASE 5
		敵BATTLE_STATE_STR:1:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアγ
	CASE 6
		敵BATTLE_STATE_STR:1:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアα
		敵BATTLE_STATE_STR:5:エネミー名 = Lv35_エンプティ・コアα
	CASE 7
		敵BATTLE_STATE_STR:0:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:1:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:3:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:5:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:7:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:8:エネミー名 = Lv35_エンプティ・コアβ
		敵BATTLE_STATE_STR:9:エネミー名 = Lv35_エンプティ・コアβ
ENDSELECT

@ダンジョンマス情報_境界への導き_19_2(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "18_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = ここは正しい道から外れているが……もう少し奥まで移動できそうだ。
				WSTR:(K++) = また魔物が出るかもしれないが、なにか良いアイテムがあるかもしれない。探索する場合は気を付けて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_20_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きを外れた道に来てみたが……周囲には大量のガラクタが浮かんでいる。
			WSTR:(K++) = どうやら気流の関係で漂流物が溜まりやすい場所のようだ。
			WSTR:(K++) = おおよそはゴミばかりだが……使えそうな道具が詰まった箱を発見した！
			WSTR:(K++) = 少し古いが、問題なく使えそうだ。ありがたく頂いていこう。
			WSTR:(K++) = %CALLNAME:MASTER%たちは「ディスペルハーブ」を３個手に入れた！
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL アイテム増減汎用処理("ディスペルハーブ", 3)
		ELSE
			KSTR:(K++) = 辺りにはガラクタが浮かんでいる。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_20_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_20_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "18_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 船が進むルートは奇妙に静かだ。
			WSTR:(K++) = 時折不安になるくらいの平穏さだが、今のところクリスタルの導きに間違いはない。
			WSTR:(K++) = こんなところは早く抜けるに越したことはない。このまま進んでいこう
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 船が進むルートは奇妙に静かだ。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_21_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 21
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きから外れてみると、異形の怪物と遭遇した！
			WSTR:(K++) = ……と思ったが、どうやら事故か何かで既に息絶えているようだ。
			WSTR:(K++) = 周囲にきらきらと、怪物からドロップしたらしき星晶の欠片が舞っている。
			WSTR:(K++) = 放って置くのももったいない。使えそうなものはもらっていこう。
			WSTR:(K++) = %CALLNAME:MASTER%たちは「星晶の欠片」を２個手に入れた！
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL 素材入手処理("星晶の欠片", 2)
		ELSE
			KSTR:(K++) = 異形の怪物が息絶えている。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_21_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 21
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "23_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 分岐が入り組んだエリアはこれで抜けられたようだ。
			WSTR:(K++) = 道のりはまだ先があるようだが、周囲の空気感が変わっている。
			WSTR:(K++) = 目的地に付くのも遠くはないだろう。このまま進んでいこう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 分岐が入り組んだエリアはこれで抜けられたようだ。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_21_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 21
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_8")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = ここは正しい道から外れているが……もう少し奥まで移動できそうだ。
				WSTR:(K++) = また魔物が出るかもしれないが、なにか良いアイテムがあるかもしれない。探索する場合は気を付けて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_22_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_4")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_5")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「↓」を指し示している。
			WSTR:(K++) = ここでも３つのルートに進むことが出来そうだ。今のところ、クリスタルが指し示す道は正しいようだが……。
			WSTR:(K++) = こんなアイテムを作ることが出来るとは、やはり%HTML_用語解説("星の民")%の技術力は凄まじい。
			WSTR:(K++) = リゾートの運営に何か役立てられないだろうか……いや、考えるのは後にして今は先に進もう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「↓」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_22_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きを外れた道に来てみたが……壊れて穴の空いた、真っ赤な騎空船が浮かんでいる。
			WSTR:(K++) = 内部に人の痕跡はない。壊れてからこの空間に飲み込まれたのだろうか。
			WSTR:(K++) = 積荷も空っぽで、特に使えそうなものはない。探索に戻ろう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 壊れて穴の空いた、真っ赤な騎空船が浮かんでいる。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_23_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 23
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		IF 初来訪マス判定用フラグ
			;移動直後はマスイベント発動しないので、移動先のルート開放をここで行う
			CALL 接続ルート全開放処理(25, 0)
		ENDIF
		ダンジョン現在位置:0 = 25
		ダンジョン現在位置:1 = 0
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_24_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 24
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_25_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 25
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "30_2")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 23
		ダンジョン現在位置:1 = 7
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_25_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 25
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの導きを外れて周囲を探索していると、突然甲板に巨大な魚が突っ込んできた！！
			WSTR:(K++) = 暴れる魚をなんとか船から叩き落とすと、そのまま風に乗ってどこかへ泳いでいった……。
			WSTR:(K++) = 今のは%HTML_用語解説("アルバコア")%の亜種だろうか？
			KSTR:(K++) = 船が破損しなくて幸いだったが……魚がいた場所に、何かきらりと光るものを見つけた。_PAGE
			WSTR:(K++) = 先ほどの魚の鱗のようだ。
			WSTR:(K++) = 大きさが程よく、少し手を加えれば耳飾りに加工出来るかもしれない。せっかくなのでもらっておこう。
			WSTR:(K++) = %CALLNAME:MASTER%たちは「アルバコアの耳飾り」を手に入れた！
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL 汎用耳飾り取得処理("アルバコアの耳飾り")
		ELSE
			KSTR:(K++) = 巨大な魚が突っ込んできた場所だ。気をつけよう。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_25_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 25
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "26_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "24_6")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「↑」を指し示している。
			WSTR:(K++) = 渦の中心に、ちらちらと光が見える。外の光だろうか？
			WSTR:(K++) = ゴールはもう少しのようだ。このまま導きに従って進もう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「↑」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_26_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 26
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "29_4")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "25_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「→」を指し示している。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「→」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_27_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 35
		ダンジョン現在位置:1 = 4
		CALL 接続ルート全開放処理(35, 4)
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_28_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 28
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_4")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルの輝きが消え、眼の前には渦の中心がある。
			WSTR:(K++) = ここに飛び込むのは少し勇気がいるが……渦の向こうからは光が差し込んでいる。
			WSTR:(K++) = 船の舵を渦の中心に向け、入ってみよう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルの輝きは消えている。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_29_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 29
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_29_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 29
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_29_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 29
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "28_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "29_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「↓」を指し示している。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「↓」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_29_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 29
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "25_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "31_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "30_8")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「←」を指し示している。
			WSTR:(K++) = 気流はますます速くなり、雲を巻き込みながら君たちの船を中央へと運んでいく。
			WSTR:(K++) = 暴風が吹き荒れる厳しい環境だが、不思議と君たちの周囲は強風程度で収まっている。
			WSTR:(K++) = クリスタルの導きが無ければ、こうやって風の隙間を縫うように進むのは難しいだろう。
			WSTR:(K++) = 道を外れないよう注意して進もう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「←」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_30_2(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 30
マス分岐 = 2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "29_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "29_0")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = クリスタルは「↓」を指し示している。
			WSTR:(K++) = 周囲の雲が螺旋を描くように中央へと流れ込んでいく光景が見える。
			WSTR:(K++) = 自然……と言っていい環境なのかはわからないが、景色全てが一つの流れに沿って動く様は畏怖すら覚える。
			WSTR:(K++) = 観光名所にすれば人気が出るだろうが、流石にこの場所まで観光客を連れてくるのは難しいだろう。
			WSTR:(K++) = クリスタルは雲の流れに沿って中央を示しているようだ。先に進もう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = クリスタルは「↓」を指し示している。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_30_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 30
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = 外のダンジョンよりも強い魔物が生息しているようだ。道を外れないよう気をつけて進もう。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_境界への導き_31_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 31
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = 
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = 
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_31_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 31
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "31_0")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_境界への導き_31_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 31
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "31_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 周囲から、強い殺気を感じる……。
			WSTR:(K++) = ここはクリスタルの導きから外れた道だ！　異形の怪物たちが君たちに襲いかかってくる！
			CALL メッセージ欄表示用関数(,,,0)
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = なんとか異形たちを撃退することに成功した。
				WSTR:(K++) = ここは正しい道から外れているが、もう少し先まで移動できそうだ。
				WSTR:(K++) = しかし、奥から強烈な殺気を感じる……！！
				WSTR:(K++) = 今は進まない方が良さそうだ……。（強敵未実装のため、進行出来ません）
				CALL メッセージ欄表示用関数(,,,0)
				;奥の道未実装
				;CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_境界への導き:マス深度:マス分岐, 4
			ENDIF
		ELSE
			CALL エネミーランダム登録_境界への導き()
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT





@ダンジョンマス情報_境界への導き_35_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 35
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "38_4")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 27
		ダンジョン現在位置:1 = 4
		CALL 画面再描画
ENDSELECT




@ダンジョンマス情報_境界への導き_38_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 38
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_暗雲
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 奇妙な空間が終わり、前方に出口が見える。
			WSTR:(K++) = 無事に目的地である「境界の世界」へと到着することができたようだ。
			WSTR:(K++) = 「星晶獣eraを救って欲しい」と、夢の中で語りかけてきた星の民タピィラは言っていた。
			WSTR:(K++) = この先にいる本人と会えば、詳しい事情を聞くことが出来るだろう。
			KSTR:(K++) = あまり悪い話ではないと良いのだが……。_PAGE
			WSTR:(K++) = 外出先に「境界の世界」が追加された！
			WSTR:(K++) = 境界への導きをクリアしました、帰還します。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 画面再描画
			ダンジョン終了状況 = 踏破達成
			ダンジョンクリアフラグ_境界への導き = 1
		ELSE
			KSTR:(K++) = 奇妙な空間が終わり、前方に出口が見える。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 画面再描画
		ENDIF
ENDSELECT































































