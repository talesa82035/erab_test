
@固有アビ_379_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 威力

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 32
	アビ名 = スウィープ・デトネーション＋＋
	消費ＭＰ = 170
	威力 = 110
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 8
	アビ名 = スウィープ・デトネーション＋
	消費ＭＰ = 160
	威力 = 100
ELSE
	アビ名 = スウィープ・デトネーション
	消費ＭＰ = 150
	威力 = 100
ENDIF



SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に各属性で{威力}％の六連続ダメージ
		SIF 基礎BATTLE_STATE:キャラ番号:Lv >= 8
			詳細文文字列受け渡し変数 += @"<br>同時に強化状態を１つ解除する。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用変数:効果割合 = 威力
		CALL アビテンプレート_ダメージ処理_火属性
		CALL アビテンプレート_ダメージ処理_水属性
		CALL アビテンプレート_ダメージ処理_風属性
		CALL アビテンプレート_ダメージ処理_土属性
		CALL アビテンプレート_ダメージ処理_光属性
		CALL アビテンプレート_ダメージ処理_闇属性
		
		SIF 基礎BATTLE_STATE:キャラ番号:Lv >= 8
			CALL アビテンプレート_不利効果_バフ消去()
		
ENDSELECT


@固有アビ_379_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 威力


;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 36
	アビ名 = ブラストイレース＋＋
	威力 = 500
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = ブラストイレース＋
	威力 = 450
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
	アビ名 = ブラストイレース
	威力 = 400
ELSE
	アビ名 = 
ENDIF

	消費ＭＰ = 120


SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に光属性の{威力}％ダメージ
		SIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			詳細文文字列受け渡し変数 += @"<br>更にDA率・TA率を10％ダウン[3ターン]"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 威力
		CALL アビテンプレート_ダメージ処理_光属性
		
		アビ汎用変数:持続ターン = 3
		アビ汎用文字列:バフ・デバフ枠 = ブラストイレース
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:基礎成功確率 = 100
		
		アビ汎用文字列:バフ・デバフ対象能力 = DA率
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		CALL アビテンプレート_不利効果_デバフ効果セット
		
ENDSELECT


@固有アビ_379_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 隊列番号

隊列番号 = キャラ隊列検索(キャラ番号)

;スキル使用時に記録したターン数と比較して、CTが過ぎているか確認
SIF 隊列番号 > -1 && (戦闘中カウント:隊列番号:0 != 0 || 現在ターン数 < 5) && 現在ターン数 < (戦闘中カウント:隊列番号:0 + 10)
	アビテンプレート用_アビ封印用フラグ = 1
	
	
;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
	アビ名 = アジャストヘイロー
	消費ＭＰ = 100
ELSE
	アビ名 = 
ENDIF



SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身にアジャストヘイロー効果を付与[永続/消去不可]
		詳細文文字列受け渡し変数 += @"<br>奥義が２連続で発動後、スウィープ・デトネーションが追加で発動するようになる。"
		詳細文文字列受け渡し変数 += @"<br>また、通常攻撃後にブラストイレースが追加で発動する。"
		詳細文文字列受け渡し変数 += @"<br>更に奥義ゲージが最大になり、ＨＰが最大値の半分になる。"
		詳細文文字列受け渡し変数 += @"<br>更に１ターン被ダメージ無効。このアビリティは行動回数を消費しない。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		アビテンプレート用_行動消費無しフラグ = 1
		
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = アジャストヘイロー
		アビ汎用文字列:バフ・デバフ対象能力 = アジャストヘイロー
		アビ汎用変数:持続ターン = -1
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		CALL アビテンプレート_有利効果_ウェポンバースト
		
		基礎BATTLE_STATE:379:ＨＰ = 基礎BATTLE_STATE:379:最大ＨＰ / 2
		
		アビ汎用変数:持続ターン = 1
		アビ汎用文字列:バフ・デバフ枠 = アジャストヘイロー_被ダメ無効
		アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
		アビ汎用変数:効果割合 = 100
		CALL アビテンプレート_有利効果_バフ効果セット
		
		戦闘中カウント:隊列番号:0 = 現在ターン数
		
ENDSELECT


@固有通常攻撃後処理_バフ_アジャストヘイロー(バフ・デバフ行数, 全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM バフ・デバフ行数
#DIM 威力値
#DIM キャラ番号

	SIF 全滅フラグ
		RETURN 0
		
		CALL アビ汎用変数文字列リセット
		アビテンプレート用_アビ名表示済フラグ = 0
		
		アビテンプレート用_アビ名 = ブラストイレース
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 36
			アビ汎用変数:効果割合 = 500
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			アビ汎用変数:効果割合 = 450
		ELSE
			アビ汎用変数:効果割合 = 400
		ENDIF
		CALL アビテンプレート_ダメージ処理_光属性
		
		アビ汎用変数:持続ターン = 3
		アビ汎用文字列:バフ・デバフ枠 = ブラストイレース
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:基礎成功確率 = 100
		
		アビ汎用文字列:バフ・デバフ対象能力 = DA率
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		CALL アビテンプレート_不利効果_デバフ効果セット


@固有奥義後処理_バフ_アジャストヘイロー(バフ・デバフ行数, 全滅フラグ)
#DIM バフ・デバフ行数
#DIM 全滅フラグ
#DIM キャラ番号

	SIF 全滅フラグ
		RETURN 0

		CALL アビ汎用変数文字列リセット
		アビテンプレート用_アビ名表示済フラグ = 0
		
		アビテンプレート用_アビ名 = エクリブリウム
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用文字列:ダメージ種類 = 奥義ダメージ
		アビ汎用変数:効果割合 = 400
		CALL アビテンプレート_ダメージ処理_自属性
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果量 = 200
		CALL アビテンプレート_ＭＰ回復処理
		
		CALL アビ汎用変数文字列リセット
		;奥義演出がもう一度出てしまう為
		;アビテンプレート用_アビ名表示済フラグ = 0
		
		アビテンプレート用_アビ名 = スウィープ・デトネーション
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 32
			アビ汎用変数:効果割合 = 110
		ELSE
			アビ汎用変数:効果割合 = 100
		ENDIF
		CALL アビテンプレート_ダメージ処理_火属性
		CALL アビテンプレート_ダメージ処理_水属性
		CALL アビテンプレート_ダメージ処理_風属性
		CALL アビテンプレート_ダメージ処理_土属性
		CALL アビテンプレート_ダメージ処理_光属性
		CALL アビテンプレート_ダメージ処理_闇属性
		
		CALL アビテンプレート_不利効果_バフ消去()
		
		
;--------------------------------------------------
;戦闘能力の固有処理説明
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_379(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

;口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;基本的にWAIT系列は使わないことを推奨

KSTR:(K++) = □ 特性 □-------------------------------------------------------------------------------
KSTR:(K++) = 　
KSTR:(K++) = 　
KSTR:(K++) = 　
KSTR:(K++) = 　

CALL 口上変数表示(対象キャラ, 1)
