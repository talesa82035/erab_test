
@固有アビ_224_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
	アビ名 = 瞬刻水凍++
	消費ＭＰ = 150
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 24
	アビ名 = 瞬刻水凍+
	消費ＭＰ = 150
ELSE
	アビ名 = 瞬刻水凍
	消費ＭＰ = 200
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の水属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>味方全体に［10％］の奥義ゲージ増加を与える。"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
			詳細文文字列受け渡し変数 += @"<br>味方全体に［回復力✕50％］のＨＰ回復を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 =200
		CALL アビテンプレート_ダメージ処理_水属性
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果量 = 10
		CALL アビテンプレート_有利効果_奥義ゲージUP
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果割合 = 50
			CALL アビテンプレート_回復処理_MAXでも回復
		ENDIF
ENDSELECT



@固有アビ_224_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ウルキ隊列

ウルキ隊列 = キャラ隊列検索(GETCHARA(224))

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 72
	アビ名 = 氷柱槌++
	IF INRANGE(ウルキ隊列, 0, 3) && 戦闘中カウント:ウルキ隊列:0 == 1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 850
	ENDIF
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = 氷柱槌+
	IF INRANGE(ウルキ隊列, 0, 3) && 戦闘中カウント:ウルキ隊列:0 == 1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 850
	ENDIF
ELSE
	アビ名 = 氷柱槌
	IF INRANGE(ウルキ隊列, 0, 3) && 戦闘中カウント:ウルキ隊列:0 == 1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 1000
	ENDIF
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕800％］の水属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>［累計50最大500］（通常枠・5ターン・消去不可）の氷結効果を与える。"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 72
			詳細文文字列受け渡し変数 += @"<br>［1］のスロウ効果を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用変数:効果割合 = 800
		CALL アビテンプレート_ダメージ処理_水属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 氷結
		アビ汎用文字列:バフ・デバフ対象能力 = 氷結
		アビ汎用変数:効果量 = 50
		アビ汎用変数:累積上限_固定値 = 500
		アビ汎用変数:持続ターン = 5
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 72
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果量 = 1
			CALL アビテンプレート_不利効果_スロウ
		ENDIF
		
		IF 戦闘中カウント:戦闘行動キャラ:0 == 1
			アビテンプレート用_行動消費無しフラグ = 1
			戦闘中カウント:戦闘行動キャラ:0 = 0
		ENDIF
ENDSELECT



@固有アビ_224_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ウルキ隊列
#DIM クールタイム

ウルキ隊列 = キャラ隊列検索(GETCHARA(224))

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
	アビ名 = 蒼鏡映姿+
	消費ＭＰ = 300
ELSE
	アビ名 = 蒼鏡映姿
	消費ＭＰ = 300
ENDIF

IF INRANGE(ウルキ隊列, 0, 3) && 戦闘中カウント:ウルキ隊列:1
	クールタイム = MAX(0, 5 + 戦闘中カウント:ウルキ隊列:1 - 現在ターン数)
	SIF クールタイム > 0
		アビテンプレート用_アビ封印用フラグ = 1
ELSE
	クールタイム = 0
ENDIF

アビ汎用文字列:実行時メッセージ１ = 反動で体力を消費した…

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}　　自身に［最大ＨＰの20％］のＨＰ減少を与える。
		詳細文文字列受け渡し変数 += @"<br>（通常枠・1ターン）の全体かばう効果効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>（通常枠・1回）の弱体無効効果を与える。"
		SIF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			詳細文文字列受け渡し変数 += @"<br>自身にウェポンバースト効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティは［5ターン］のＣＴが発生する。"
		SIF クールタイム > 0
			詳細文文字列受け渡し変数 += @"（残り{クールタイム}ターン）"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_自己のみ
		
		BATTLE_STATE:ウルキ隊列:ＨＰ -= BATTLE_STATE:ウルキ隊列:最大ＨＰ / 5
		
		アビ汎用文字列:バフ・デバフ枠 = 全体かばう
		アビ汎用文字列:バフ・デバフ対象能力 = 全体かばう
		アビ汎用変数:持続ターン = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			CALL アビテンプレート_有利効果_ウェポンバースト
		ENDIF
		
		アビテンプレート用_行動消費無しフラグ = 1
		戦闘中カウント:ウルキ隊列:1 = 現在ターン数
ENDSELECT



@固有ターン終了時処理_キャラ_224

CALL アビテンプレート用_表示メッセージ変換処理
アビテンプレート用_アビ名表示済フラグ = 0
アビ汎用文字列:実行時メッセージ１ = ウルキの瞬刻水凍！

CALL アビ対象選択テンプレート_敵ランダムＸ体(1)
アビ汎用変数:効果割合 =200
CALL アビテンプレート_ダメージ処理_水属性

CALL アビ汎用変数文字列リセット
CALL アビ対象選択テンプレート_味方全体_生者のみ
アビ汎用変数:効果量 = 10
CALL アビテンプレート_有利効果_奥義ゲージUP

IF 基礎BATTLE_STATE:GETCHARA(224):Lv >= 56
	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果量 = 100
	CALL アビテンプレート_回復処理_MAXでも回復
ENDIF



; @バフ・デバフ特殊表示_氷結(隊列番号, バフ・デバフ行数)
; #DIM 隊列番号
; #DIM バフ・デバフ行数
; VARSET LOCALS

; PRINTFORML 氷結
; PRINTFORML Lvに応じて毎ターンダメージを受ける状態［最大Lv10/回復不可］
; PRINTFORML Lv：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "効果量_固定値") / 50}　　　　　持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



;--------------------------------------------------
;戦闘能力画面に表示されるキャラごとの固有処理説明
;--------------------------------------------------
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;　口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;　基本的にWAIT系列は使わないことを推奨
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_224(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

KSTR:(K++) = □ 特性：『寂寞求温』 □------------------------------------------------------------
KSTR:(K++) = 　連続攻撃率が低いがターン終了時に瞬刻水凍が発動
KSTR:(K++) = 　水属性のチェインバースト発生時、チェイン数が2増加

CALL 口上変数表示(対象キャラ, 1)



